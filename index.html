<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assembly Prototype</title>

    <!-- Early console capture - must be first! -->
    <script>
        // Capture ALL console output from the very beginning
        window.earlyLogs = [];
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        const originalInfo = console.info;

        function captureConsoleOutput(type, args) {
            // Get call stack information
            const stack = new Error().stack;
            const stackLines = stack ? stack.split('\n').slice(2) : []; // Skip Error constructor and this function

            // Parse stack to get file and line info
            const callInfo = stackLines.map(line => {
                const match = line.match(/at\s+(.+?)\s+\((.+?):(\d+):(\d+)\)/);
                if (match) {
                    return {
                        function: match[1],
                        file: match[2],
                        line: parseInt(match[3]),
                        column: parseInt(match[4])
                    };
                }
                // Handle anonymous functions
                const anonMatch = line.match(/at\s+(.+?):(\d+):(\d+)/);
                if (anonMatch) {
                    return {
                        function: '(anonymous)',
                        file: anonMatch[1],
                        line: parseInt(anonMatch[2]),
                        column: parseInt(anonMatch[3])
                    };
                }
                return null;
            }).filter(Boolean);

            window.earlyLogs.push({
                type,
                args,
                timestamp: new Date().toISOString(),
                callStack: callInfo
            });
        }

        console.log = function (...args) {
            originalLog.apply(console, args);
            captureConsoleOutput('LOG', args);
        };

        console.warn = function (...args) {
            originalWarn.apply(console, args);
            captureConsoleOutput('WARN', args);
        };

        console.error = function (...args) {
            originalError.apply(console, args);
            captureConsoleOutput('ERROR', args);
        };

        console.info = function (...args) {
            originalInfo.apply(console, args);
            captureConsoleOutput('INFO', args);
        };
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .assembly-accent {
            /* Light blue accent for playhead, VU, highlights */
            --tw-bg-opacity: 1;
            background-color: rgb(56 189 248 / var(--tw-bg-opacity));
            /* sky-400 */
        }

        .assembly-accent-text {
            color: rgb(56 189 248);
        }

        .assembly-vu {
            background: linear-gradient(to top, #38bdf8 0%, #e0f2fe 100%);
        }

        .track-grid-bg {
            background: repeating-linear-gradient(to right,
                    #334155 0px,
                    #334155 2px,
                    transparent 2px,
                    transparent 40px);
        }
    </style>
</head>

<body class="bg-gray-900 min-h-screen text-gray-100">
    <!-- HEADER / MENU BAR -->
    <header class="w-full bg-gray-800 border-b border-gray-700 flex items-center px-6 py-2 relative">
        <span class="text-2xl mr-4">üéõÔ∏è</span>
        <span class="font-bold text-xl tracking-wide mr-8">Assembly</span>
        <nav class="flex space-x-6 text-gray-200">
            <div class="relative group">
                <button class="focus:outline-none">Load <span class="ml-1">‚ñº</span></button>
            </div>
            <button class="opacity-70 cursor-default">Save</button>
            <button class="opacity-70 cursor-default">Analyze</button>
            <button class="opacity-70 cursor-default">Details</button>
            <button class="opacity-70 cursor-default">Settings</button>
            <button class="opacity-70 cursor-default">Help</button>
            <button class="opacity-70 cursor-default">License</button>
        </nav>
        <!-- Window controls -->
        <div class="absolute right-4 top-1 flex space-x-2 text-lg">
            <button title="Minimize" class="hover:text-sky-400">üóï</button>
            <button title="Maximize" class="hover:text-sky-400">üóñ</button>
            <button title="Close" class="hover:text-red-400">üóô</button>
        </div>
    </header>

    <!-- MAIN CONTENT: full height minus header -->
    <main class="flex flex-row w-full max-w-[1600px] mx-auto" style="height: calc(100vh - 56px);">
        <!-- LEFT SIDEBAR -->
        <aside
            class="w-64 bg-gray-800 border-r border-gray-700 flex flex-col py-4 px-2 mr-6 rounded-lg shadow-lg h-full overflow-y-auto">
            <!-- TRANSPORT CONTROLS -->
            <div class="flex flex-row items-center space-x-2 mb-6 justify-center">
                <button
                    class="w-10 h-10 bg-gray-700 border-2 border-gray-600 rounded flex items-center justify-center text-xl assembly-accent hover:bg-sky-700"
                    title="Play/Pause">‚ñ∂</button>
                <button
                    class="w-10 h-10 bg-gray-700 border-2 border-gray-600 rounded flex items-center justify-center text-xl text-sky-400 hover:bg-sky-700"
                    title="Stop">‚èπ</button>
                <button
                    class="w-10 h-10 bg-gray-700 border-2 border-gray-600 rounded flex items-center justify-center text-xl text-sky-400 hover:bg-sky-700"
                    title="Rewind">‚èÆ</button>
                <button
                    class="w-10 h-10 bg-gray-700 border-2 border-gray-600 rounded flex items-center justify-center text-xl text-sky-400 hover:bg-sky-700"
                    title="Fast Forward">‚è≠</button>
            </div>
            <div class="flex flex-row items-center space-x-2 mb-8 justify-center">
                <label class="flex items-center space-x-2 cursor-pointer select-none">
                    <input type="checkbox" checked class="form-checkbox text-sky-400 h-5 w-5" />
                    <span class="text-sky-400 text-sm">Loop</span>
                </label>
            </div>
            <!-- CLIP REPOSITORY -->
            <div class="flex-1 overflow-y-auto">
                <div class="mb-4">
                    <div class="flex items-center mb-2 text-sky-400 font-semibold"><span class="mr-2">üé§</span>Vocals
                    </div>
                    <div class="flex flex-col space-y-2 ml-6">
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Lead Take 1</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Lead Take 2</div>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="flex items-center mb-2 text-sky-400 font-semibold"><span class="mr-2">ü•Å</span>Drums
                    </div>
                    <div class="flex flex-col space-y-2 ml-6">
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Rock Beat</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Funk Groove</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Jazz Shuffle</div>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="flex items-center mb-2 text-sky-400 font-semibold"><span class="mr-2">üé∏</span>Bass
                    </div>
                    <div class="flex flex-col space-y-2 ml-6">
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Walking Bass</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Synth Bass</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Slap Bass</div>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="flex items-center mb-2 text-sky-400 font-semibold"><span class="mr-2">üéπ</span>Guitar
                    </div>
                    <div class="flex flex-col space-y-2 ml-6">
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Clean Chords</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Distorted Riff</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Arpeggio</div>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="flex items-center mb-2 text-sky-400 font-semibold"><span class="mr-2">üîä</span>FX</div>
                    <div class="flex flex-col space-y-2 ml-6">
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Reverb</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Delay</div>
                        <div class="bg-gray-700 rounded px-2 py-1 text-xs">Filter</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- TIMELINE + FILENAME -->
        <section class="flex-1 flex flex-col pr-6 h-full overflow-hidden">
            <!-- FILENAME -->
            <div class="text-sm text-gray-400 mb-2 pl-2">File: <span class="text-gray-200">my_project.ass</span></div>
            <!-- TIMELINE AREA -->
            <div class="bg-gray-800 rounded-lg shadow-lg relative overflow-hidden flex flex-col h-full">
                <!-- TIMESTAMP & TIMELINE HEADER -->
                <div class="flex items-center justify-between px-4 pt-3 pb-1 border-b border-gray-700">
                    <div class="font-mono text-xs assembly-accent-text">00:17.6 / 01:45.0</div>
                    <div class="text-xs text-sky-400 font-bold">BPM: 110</div>
                </div>
                <!-- TIMELINE GRID/TRACKS -->
                <div class="relative flex-1 flex flex-col">
                    <!-- Playhead (vertical line) -->
                    <div class="absolute top-0 left-[120px] w-1 h-full assembly-accent opacity-80 z-20"></div>
                    <!-- Grid (vertical bars) -->
                    <div class="absolute inset-0 z-10 track-grid-bg pointer-events-none"></div>
                    <!-- Tracks -->
                    <div class="relative z-20 flex flex-col h-full">
                        <!-- 6 tracks -->
                        <div class="flex-1 flex items-center border-b border-gray-700 last:border-b-0 min-h-[48px]"
                            style="height:16.6%">
                            <div class="flex items-center w-24 pl-2 space-x-2 min-w-[90px]">
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Solo">üéß</button>
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Mute">üîá</button>
                            </div>
                            <div class="w-36 text-xs font-bold text-gray-300 truncate">TRACK 1</div>
                            <div class="flex-1 flex items-center space-x-2 min-w-0">
                                <div class="h-6 w-16 bg-sky-900 rounded mr-2"></div>
                                <div class="h-6 w-24 bg-sky-700 rounded"></div>
                            </div>
                        </div>
                        <div class="flex-1 flex items-center border-b border-gray-700 last:border-b-0 min-h-[48px]"
                            style="height:16.6%">
                            <div class="flex items-center w-24 pl-2 space-x-2 min-w-[90px]">
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Solo">üéß</button>
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Mute">üîá</button>
                            </div>
                            <div class="w-36 text-xs font-bold text-gray-300 truncate">TRACK 2</div>
                            <div class="flex-1 flex items-center space-x-2 min-w-0">
                                <div class="h-6 w-20 bg-sky-900 rounded mr-2"></div>
                                <div class="h-6 w-16 bg-sky-700 rounded"></div>
                            </div>
                        </div>
                        <div class="flex-1 flex items-center border-b border-gray-700 last:border-b-0 min-h-[48px]"
                            style="height:16.6%">
                            <div class="flex items-center w-24 pl-2 space-x-2 min-w-[90px]">
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Solo">üéß</button>
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Mute">üîá</button>
                            </div>
                            <div class="w-36 text-xs font-bold text-gray-300 truncate">TRACK 3</div>
                            <div class="flex-1 flex items-center space-x-2 min-w-0">
                                <div class="h-6 w-24 bg-sky-900 rounded mr-2"></div>
                                <div class="h-6 w-12 bg-sky-700 rounded"></div>
                            </div>
                        </div>
                        <div class="flex-1 flex items-center border-b border-gray-700 last:border-b-0 min-h-[48px]"
                            style="height:16.6%">
                            <div class="flex items-center w-24 pl-2 space-x-2 min-w-[90px]">
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Solo">üéß</button>
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Mute">üîá</button>
                            </div>
                            <div class="w-36 text-xs font-bold text-gray-300 truncate">TRACK 4</div>
                            <div class="flex-1 flex items-center space-x-2 min-w-0">
                                <div class="h-6 w-16 bg-sky-900 rounded mr-2"></div>
                                <div class="h-6 w-20 bg-sky-700 rounded"></div>
                            </div>
                        </div>
                        <div class="flex-1 flex items-center border-b border-gray-700 last:border-b-0 min-h-[48px]"
                            style="height:16.6%">
                            <div class="flex items-center w-24 pl-2 space-x-2 min-w-[90px]">
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Solo">üéß</button>
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Mute">üîá</button>
                            </div>
                            <div class="w-36 text-xs font-bold text-gray-300 truncate">TRACK 5</div>
                            <div class="flex-1 flex items-center space-x-2 min-w-0">
                                <div class="h-6 w-20 bg-sky-900 rounded mr-2"></div>
                                <div class="h-6 w-24 bg-sky-700 rounded"></div>
                            </div>
                        </div>
                        <div class="flex-1 flex items-center min-h-[48px]" style="height:16.6%">
                            <div class="flex items-center w-24 pl-2 space-x-2 min-w-[90px]">
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Solo">üéß</button>
                                <button
                                    class="w-7 h-7 flex items-center justify-center text-lg text-sky-400 hover:bg-gray-700 rounded"
                                    title="Mute">üîá</button>
                            </div>
                            <div class="w-36 text-xs font-bold text-gray-300 truncate">TRACK 6</div>
                            <div class="flex-1 flex items-center space-x-2 min-w-0">
                                <div class="h-6 w-24 bg-sky-900 rounded mr-2"></div>
                                <div class="h-6 w-16 bg-sky-700 rounded"></div>
                            </div>
                        </div>
                    </div>
                    <!-- ADD TRACK BUTTON -->
                    <div class="w-full flex justify-center mt-2">
                        <button class="bg-sky-700 hover:bg-sky-600 text-white font-semibold py-2 px-8 rounded shadow">+
                            Add Track</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- VU METER -->
        <aside class="w-16 flex flex-col items-center justify-center h-full overflow-hidden">
            <div
                class="h-full w-6 rounded bg-gray-700 mt-12 flex flex-col-reverse overflow-hidden border border-sky-400">
                <div class="assembly-vu w-full" style="height: 60%"></div>
            </div>
            <div class="text-xs text-gray-400 mt-2">L&nbsp;&nbsp;R</div>
        </aside>
    </main>
    <script src="app.js"></script>
</body>

</html>